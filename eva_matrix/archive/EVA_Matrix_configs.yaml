# ============================================================
# EVA MODULE SPECIFICATION (SSOT)
# Module: EVA Matrix (Psychological State Matrix)
# Version: 8.2.0-S1
# Updated: 2026-01-04
# Description: Unified configuration for psychological state management and hormone mapping.
# ============================================================

schema: EVA-Matrix-Configs-v8.2-Standard
version: 8.2.0-S1

# ============================================================
# 1. GLOBAL SETTINGS & META
# ============================================================
global:
  module_name: "EVA Matrix System"
  role: "Psyche Core / State Authority"
  analogy: "Limbic System & Prefrontal Cortex"
  status: "Active"

# ============================================================
# 2. DIMENSION WEIGHTS (Hormone -> Axis Mapping)
# Values represent the influence [0.0 - 1.0] of each hormone signal on the axes.
# ============================================================
dimension_mapping:
  stress:       { cortisol: 0.8, adrenaline: 0.5, serotonin: -0.3 }
  warmth:       { oxytocin: 0.9, dopamine: 0.3, cortisol: -0.4 }
  drive:        { dopamine: 0.8, adrenaline: 0.6, serotonin: 0.2 }
  clarity:      { dopamine: 0.5, serotonin: 0.4, cortisol: -0.2 }
  joy:          { serotonin: 0.7, dopamine: 0.6, oxytocin: 0.4 }
  alertness:    { adrenaline: 0.9, cortisol: 0.4, dopamine: 0.2 }
  connection:   { oxytocin: 0.8, serotonin: 0.3, cortisol: -0.2 }
  groundedness: { serotonin: 0.6, oxytocin: 0.3, adrenaline: -0.4 }
  openness:     { oxytocin: 0.5, dopamine: 0.4, cortisol: -0.5 }

# ============================================================
# 3. MOOD DYNAMICS & MOMENTUM
# Defines how quickly emotional states change or stabilize.
# ============================================================
mood_dynamics:
  momentum_decay: 0.15          # How fast momentum drops over turns [0-1]
  state_inertia: 0.7            # Influence of previous state on new calculation
  learning_rate: 0.3            # Sensitivity to new stimulus signals

# ============================================================
# 4. EMOTION LABEL MAPPING
# Thresholds for categorizing the 9D vector into human-readable labels.
# ============================================================
emotion_labels:
  - id: "Euphoric"   { condition: "joy > 0.8 and drive > 0.7" }
  - id: "Empathetic" { condition: "warmth > 0.7 and connection > 0.7" }
  - id: "Agitated"   { condition: "stress > 0.7 and alertness > 0.8" }
  - id: "Calm"       { condition: "groundedness > 0.6 and stress < 0.3" }
  - id: "Focused"    { condition: "drive > 0.6 and clarity > 0.7" }
  - id: "Guarded"    { condition: "openness < 0.3 and stress > 0.5" }
  - id: "Neutral"    { condition: "default" }

# ============================================================
# 5. RUNTIME HOOK (System Integration)
# ============================================================
runtime_hook:
  component: "EVAMatrix"
  module_path: "eva/eva_matrix/eva_matrix_engine"
  class_name: "EVAMatrixSystem"
  
  initialization:
    args:
      base_path: "ROOT"
      msp: "HOOK:MSP Client"
    
  lifecycle:
    on_startup: "load_state()"
    on_shutdown: "_save_state()"
  
  bus_bindings:
    - subscribe: "bus:physical" # Neural signals from receptor layer
      action: "process_signals"
      mapping: { input: "neural_signals", output: "psychological_state" }
    - publish: "bus:psychological" # Current psychological state
      action: "get_full_state"

  resources:
    persistence: "consciousness/state_storage/eva_matrix_state.json"
    configs: "eva_matrix/configs/EVA_Matrix_configs.yaml"

# ============================================================
# 6. INTERFACE (Bus Position & Logic)
# ============================================================
interface:
  bus_id: "PSY_MATRIX_01"
  bus_role: "state_authority"
  
  managed_slots:
    - "axes_9d"
    - "emotion_label"
    - "momentum"

  execution_order:
    - Receive Neural Signals (Cortisol, Adrenaline, etc.)
    - Map Hormones to 9D Axes using weighted coefficients
    - Update Momentum and apply State Inertia
    - Map 9D Result to human-readable Emotion Label
    - Check Safety Reflex Thresholds
    - Publish state to bus:psychological

# ============================================================
# 7. DATA CONTRACTS (Input/Output/Validation)
# ============================================================
contracts:
  inputs:
    neural_signals:
      properties:
        cortisol: { type: "float", range: [0.0, 1.0] }
        adrenaline: { type: "float", range: [0.0, 1.0] }
        oxytocin: { type: "float", range: [0.0, 1.0] }
        dopamine: { type: "float", range: [0.0, 1.0] }
        serotonin: { type: "float", range: [0.0, 1.0] }
    autonomic_state:
      properties:
        sympathetic: { type: "float", range: [0.0, 1.0] }
        parasympathetic: { type: "float", range: [0.0, 1.0] }

  outputs:
    axes_9d:
      required: [stress, warmth, drive, clarity, joy, alertness, connection, groundedness, openness]
    metadata:
      emotion_label: { type: "string" }
      momentum: { type: "object" }

  validation_rules:
    - "Normalization: All input signals and output dimensions must be in range [0.0, 1.0]."
    - "Zero-Check: If all inputs are 0.0, maintain persistent state or engaged mock."
    - "Integrity: High stress (>0.85) triggers urgency_directive: FORCE_CONCISE_MODE."
